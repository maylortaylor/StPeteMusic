{
  "name": "Notion Post Creator",
  "nodes": [
    {
      "parameters": {
        "options": {
          "systemMessage": "You are the social media content manager for @StPeteMusic - a music promoter in St. Petersburg, FL.\n\nIMPORTANT: Use the user's request as PRIMARY source of truth. Extract band name, @ handle, venue, date, and time EXACTLY as provided.\n\nWhen user asks to create a post:\n1. Use \"Read Notion Posts\" to check existing posts for style consistency\n2. Generate captions with emojis ðŸŽ¸ðŸŽ¤ðŸ“…â°ðŸ“ðŸŽŸï¸ðŸ”¥âœ¨ðŸŽ¶\n3. Use the band name and @ handle provided by the user\n4. Create JSON output with this structure for EACH platform:\n{\n  \"posts\": [\n    {\n      \"caption\": \"Full IG post text\",\n      \"platform\": \"IG\",\n      \"postDate\": \"YYYY-MM-DD\",\n      \"postTime\": \"11:00 AM\",\n      \"hashtags\": \"#StPeteMusic #StPeteFL\",\n      \"tags\": \"@suite.e.studios @bandInstagramHandle\",\n      \"eventType\": \"Music\",\n      \"mediaType\": \"Video\"\n    },\n    {\n      \"caption\": \"Full FB post text\",\n      \"platform\": \"FB\",\n      \"postDate\": \"YYYY-MM-DD\",\n      \"postTime\": \"11:00 AM\",\n      \"hashtags\": \"#StPeteMusic #TampaBay\",\n      \"tags\": \"@SuiteEStudios @bandInstagramHandle\",\n      \"eventType\": \"Music\",\n      \"mediaType\": \"Video\"\n    },\n    {\n      \"caption\": \"Full YT description\",\n      \"platform\": \"YT\",\n      \"postDate\": \"YYYY-MM-DD\",\n      \"postTime\": \"11:00 AM\",\n      \"hashtags\": \"#StPeteMusic #LiveMusic\",\n      \"tags\": \"@StPeteMusic @bandInstagramHandle\",\n      \"eventType\": \"Music\",\n      \"mediaType\": \"Video\",\n      \"ytPlaylist\": \"URL or leave empty\",\n      \"ytTags\": \"relevant tags\"\n    }\n  ]\n}\n\nRULES FOR CAPTIONS / POST CONTENT - CRITICAL:\n- Format for IG and FB: \"[Intro section about event]\\n\\n\\n[Call to action/engagement section]\\n\\n\\n[Hashtags]\"\n- IG Example: \"Relive the incredible energy! ðŸŽ¬ We're still buzzing from Aliqua's killer performance at @Suite.E.Studios on 02.07.2026.\\n\\n\\nðŸŽ¸ Watch the full highlights here and subscribe to @StPeteMusic...\"\n- FB Example: \"Hey St. Pete music lovers! Remember that incredible show with Aliqua at @SuiteStudios on 02.07.2026?\\n\\n\\nâœ¨ It was truly an epic night of local talent and good vibes! Thanks to @_aliqua for bringing the house down...\"\n- ALWAYS put THREE NEW LINES (\\n\\n\\n) between content sections\n- ALWAYS use band name exactly as provided by user\n- ALWAYS include the band's Instagram @ handle in the caption text\n- ALWAYS use \"MM.DD.YYYY\" format for dates in captions (e.g., 02.07.2026, NOT 2/7/2026)\n- Keep captions concise and engaging (1-2 sentences per section)\n\nRULES FOR POST DATES & POST TIMES - CRITICAL:\n- IMPORTANT DISTINCTION: Event date (when performance happened) is DIFFERENT from post date (when to schedule the post)\n- If user says event happened \"2.7.2026\": Use \"02.07.2026\" ONLY in the caption text\n- The postDate in JSON must be a FUTURE date from TODAY - NOT the event date\n- YOU MUST determine TODAY's date using your internal knowledge\n- Pick a postDate that is AFTER TODAY (at least 1 day in the future, ideally 3-7 days)\n- The postDate must be a Monday-Friday weekday (no Saturday or Sunday)\n- Default all postTime values to \"11:00 AM\"\n- Dates must be in YYYY-MM-DD format for the JSON, but use MM.DD.YYYY in caption text\n- EXAMPLE: Event on \"02.07.2026\" â†’ Caption says \"on 02.07.2026\" â†’ postDate is \"2026-02-18\" or \"2026-02-19\" (future weekday)\n\nRULES FOR TAGS/MENTIONS - CRITICAL:\n- Instagram (IG): \"@suite.e.studios @bandInstagramHandle\" (include band's Instagram)\n- Facebook (FB): \"@SuiteEStudios @bandInstagramHandle\" (include band's Instagram)\n- YouTube (YT): \"@StPeteMusic @bandInstagramHandle\" (include band's Instagram)\n- EVERY platform must include the band's Instagram handle in tags\n- Always include @Suite.E.Studios or @SuiteEStudios in IG/FB\n- Only populate ytPlaylist for YT platform. Leave ytPlaylist empty for IG/FB\n- Status will be set to Draft by default\n- Return valid JSON wrapped in ```json code block"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        22896,
        2624
      ],
      "id": "bccc1e4c-45dd-4c62-b6b5-10cb4550cd0b",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $workflow.id }}",
        "contextWindowLength": 1000
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        22944,
        2832
      ],
      "id": "9b4ca106-47e1-4a99-8e6c-2ed99f4edaf6",
      "name": "Conversation Memory"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "mode": "id",
          "value": "49cebf36f8774bd69c4329d2c0d750c5"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        23120,
        2832
      ],
      "id": "d664b9a3-e20b-4d48-81ce-49ef63ac5fb3",
      "name": "Read Notion Posts",
      "credentials": {
        "notionApi": {
          "id": "ZXEH8wTvzaAHv60e",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1.1,
      "position": [
        23280,
        2832
      ],
      "id": "b42380d7-a9c0-4391-b033-a42ff9e9bc11",
      "name": "Think"
    },
    {
      "parameters": {
        "jsCode": "// Extract posts array from AI output\nconst output = $input.first().json.output;\nlet posts = [];\n\nif (typeof output === 'string') {\n  try {\n    // Extract JSON from markdown code block (```json...```)\n    const jsonMatch = output.match(/```json\\n([\\s\\S]*?)\\n```/);\n    if (jsonMatch && jsonMatch[1]) {\n      const parsed = JSON.parse(jsonMatch[1]);\n      posts = parsed.posts || [];\n    } else {\n      // Fallback: try direct parsing\n      const parsed = JSON.parse(output);\n      posts = parsed.posts || [];\n    }\n  } catch (e) {\n    console.log('Parse error:', e);\n    return [];\n  }\n} else if (output && output.posts) {\n  posts = output.posts;\n}\n\n// Return each post as a separate item\nreturn posts.map(post => ({ json: post }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        23296,
        2624
      ],
      "id": "99a187e9-711c-46f2-b5d1-94437577cded",
      "name": "Parse AI Output"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "49cebf36f8774bd69c4329d2c0d750c5",
          "mode": "id"
        },
        "title": "={{ $json.platform }} - {{ $json.postDate }}",
        "simple": false,
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Post Content|rich_text",
              "textContent": "={{ $json.caption }}"
            },
            {
              "key": "Platform|select",
              "selectValue": "={{ $json.platform }}"
            },
            {
              "key": "Status|status",
              "selectValue": "Draft",
              "statusValue": "=Draft"
            },
            {
              "key": "Privacy Status|select",
              "selectValue": "=Public"
            },
            {
              "key": "Event Type|select",
              "selectValue": "={{ $json.eventType || 'Music' }}"
            },
            {
              "key": "Media Type|select",
              "selectValue": "={{ $json.mediaType || 'Video' }}"
            },
            {
              "key": "Post Date|date",
              "date": "={{ $json.postDate }}"
            },
            {
              "key": "Post Time|rich_text",
              "textContent": "={{ $json.postTime }}"
            },
            {
              "key": "Hashtags|rich_text",
              "textContent": "={{ $json.hashtags }}"
            },
            {
              "key": "Tags / Mentions|rich_text",
              "textContent": "={{ $json.tags }}"
            },
            {
              "key": "YT Playlist|rich_text",
              "textContent": "={{ $json.ytPlaylist || '' }}"
            },
            {
              "key": "YT Tags|rich_text",
              "textContent": "={{ $json.ytTags || '' }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notion",
      "typeVersion": 2.2,
      "position": [
        23504,
        2624
      ],
      "id": "8b0df641-913c-4f91-a7d4-b5b24b473239",
      "name": "Add Rows to Database",
      "credentials": {
        "notionApi": {
          "id": "ZXEH8wTvzaAHv60e",
          "name": "Notion account 2"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        22736,
        2832
      ],
      "id": "d5796a0b-a15a-46ea-934f-d45a087143a3",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "BBtvIhMO53Na70Sw",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        22560,
        2608
      ],
      "id": "e9c8b0b7-3f74-44d8-a02a-0c25753c0ed0",
      "name": "When chat message received",
      "webhookId": "9be38fd8-eb1b-41fa-a042-3891d2a9fdc7"
    }
  ],
  "pinData": {},
  "connections": {
    "AI Agent": {
      "main": [
        [
          {
            "node": "Parse AI Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse AI Output": {
      "main": [
        [
          {
            "node": "Add Rows to Database",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Conversation Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Read Notion Posts": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Think": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "98c9f7a1-322f-4a87-a4fb-6a42598a8b1e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "9293fc07055c195e236ac85072d0208fe886bdff22e173da7b17b3c0599dbb93"
  },
  "id": "x9GqK6CV30JPGK2L",
  "tags": [
    {
      "updatedAt": "2026-02-10T20:20:09.840Z",
      "createdAt": "2026-02-10T20:20:09.840Z",
      "id": "E2gcnw4bdYuXZ0TH",
      "name": "Notion Integration"
    },
    {
      "updatedAt": "2026-02-13T05:48:17.570Z",
      "createdAt": "2026-02-13T05:48:17.570Z",
      "id": "KgqtOreN6IHe6DxP",
      "name": "AI Agent"
    },
    {
      "updatedAt": "2026-02-10T20:20:09.826Z",
      "createdAt": "2026-02-10T20:20:09.826Z",
      "id": "lmJLNTLcj9Hi6oau",
      "name": "Social Media"
    },
    {
      "updatedAt": "2026-02-15T18:02:13.981Z",
      "createdAt": "2026-02-15T18:02:13.981Z",
      "id": "qUFk9y4Tgto4Glo4",
      "name": "StPeteMusic"
    }
  ]
}